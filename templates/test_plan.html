<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Test Plan - {{ suite_name }}</title>
<style>
  body { font-family: -apple-system, sans-serif; margin: 40px; background: #f5f5f5; }
  h1 { color: #333; }
  h2 { color: #555; margin-top: 30px; }
  .summary { display: flex; gap: 20px; margin: 20px 0; }
  .card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,.1); }
  .card.adb_check { border-left: 4px solid #2196f3; }
  .card.adb_shell { border-left: 4px solid #4caf50; }
  .card.screenshot_llm { border-left: 4px solid #9c27b0; }
  .card.apk_instrumentation { border-left: 4px solid #ff9800; }
  .card h3 { margin: 0 0 8px 0; color: #666; font-size: 14px; }
  .card .value { font-size: 32px; font-weight: bold; }
  table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,.1); }
  th { background: #333; color: white; padding: 12px; text-align: left; }
  td { padding: 10px 12px; border-bottom: 1px solid #eee; vertical-align: top; }
  .type-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 12px; color: white; }
  .type-adb_check { background: #2196f3; }
  .type-adb_shell { background: #4caf50; }
  .type-screenshot_llm { background: #9c27b0; }
  .type-apk_instrumentation { background: #ff9800; }
  .criteria { font-size: 13px; color: #333; }
  .extra { font-size: 12px; color: #888; margin-top: 4px; }
  code { background: #f0f0f0; padding: 2px 6px; border-radius: 3px; font-size: 13px; }
  .meta { color: #999; font-size: 14px; margin-bottom: 20px; }
</style>
</head>
<body>
<h1>Test Plan</h1>
<p class="meta">Suite: {{ suite_name }} | Generated: {{ timestamp }}</p>

<div class="summary">
  <div class="card"><h3>Total Tests</h3><div class="value">{{ total }}</div></div>
  {% for type_name, count in type_counts.items() %}
  <div class="card {{ type_name }}"><h3>{{ type_name }}</h3><div class="value">{{ count }}</div></div>
  {% endfor %}
</div>

<h2>Test Details</h2>
<table>
  <tr>
    <th>ID</th>
    <th>Name</th>
    <th>Type</th>
    <th>Command / Prompt</th>
    <th>Pass Criteria</th>
    <th>Conditions</th>
  </tr>
  {% for t in tests %}
  <tr>
    <td><code>{{ t.id }}</code></td>
    <td>{{ t.name }}</td>
    <td><span class="type-badge type-{{ t.type }}">{{ t.type }}</span></td>
    <td><code>{{ t.command }}</code></td>
    <td class="criteria">{{ t.pass_criteria_display }}</td>
    <td>
      {% if t.depends_on %}<div class="extra">depends_on: <code>{{ t.depends_on }}</code></div>{% endif %}
      {% if t.requires %}<div class="extra">requires: <code>{{ t.requires }}</code></div>{% endif %}
      {% if t.retry %}<div class="extra">retry: {{ t.retry }}{% if t.retry_delay %} (delay {{ t.retry_delay }}s){% endif %}</div>{% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
</body>
</html>
